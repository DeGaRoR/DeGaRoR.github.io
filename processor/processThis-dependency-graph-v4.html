<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>processThis — Dependency Graph (rev 4)</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #0d1117; color: #c9d1d9; font-family: -apple-system, 'Segoe UI', sans-serif; padding: 32px; }
  h1 { font-size: 20px; font-weight: 600; margin-bottom: 4px; color: #e6edf3; }
  .subtitle { font-size: 13px; color: #8b949e; margin-bottom: 24px; }
  svg { display: block; margin: 0 auto; }
  .stage { cursor: default; }
  .stage rect { rx: 8; ry: 8; stroke-width: 2; transition: filter 0.2s; }
  .stage:hover rect { filter: brightness(1.3) drop-shadow(0 0 8px rgba(255,255,255,0.15)); }
  .stage text { font-family: -apple-system, 'Segoe UI', sans-serif; pointer-events: none; }
  .label { font-size: 13px; font-weight: 600; fill: #e6edf3; }
  .desc { font-size: 10px; fill: #8b949e; }
  .spec { font-size: 9px; fill: #58a6ff; font-style: italic; }
  .tests { font-size: 9px; fill: #7ee787; }
  .arrow { stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
  .arrow-crit { stroke: #f0883e; }
  .arrow-dep { stroke: #484f58; stroke-dasharray: 6 3; }
  .arrow-merge { stroke: #bc8cff; stroke-dasharray: 4 4; }
  .legend { font-size: 11px; }
  .legend rect { rx: 3; ry: 3; }
  .legend text { fill: #8b949e; }
  .legend line { stroke-width: 2; }
</style>
</head>
<body>
<h1>processThis — Dependency Graph</h1>
<div class="subtitle">Rev 4 · February 2026 · Engine-first roadmap</div>

<svg viewBox="0 0 900 680" width="900" height="680">
  <defs>
    <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#484f58"/>
    </marker>
    <marker id="arrowhead-crit" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#f0883e"/>
    </marker>
    <marker id="arrowhead-merge" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#bc8cff"/>
    </marker>
  </defs>

  <!-- CRITICAL PATH: S1 → S2 → S3 → S5 (center column) -->

  <!-- S1 -->
  <g class="stage" transform="translate(300, 20)">
    <rect x="0" y="0" width="280" height="72" fill="#1c2333" stroke="#f0883e"/>
    <text x="140" y="20" text-anchor="middle" class="label">S1: Equipment Limits + Chemistry</text>
    <text x="140" y="35" text-anchor="middle" class="desc">Envelopes · CO · 7 reactions · thermo fixes</text>
    <text x="140" y="49" text-anchor="middle" class="spec">equipment_limits_S · heatStream Ph2+6 · AUDIT_thermo</text>
    <text x="140" y="63" text-anchor="middle" class="tests">~15 tests → 304 cumulative</text>
  </g>

  <!-- S2 -->
  <g class="stage" transform="translate(300, 130)">
    <rect x="0" y="0" width="280" height="72" fill="#1c2333" stroke="#f0883e"/>
    <text x="140" y="20" text-anchor="middle" class="label">S2: Power Management</text>
    <text x="140" y="35" text-anchor="middle" class="desc">Overload · fry · priority allocation</text>
    <text x="140" y="49" text-anchor="middle" class="spec">v13_power_spec</text>
    <text x="140" y="63" text-anchor="middle" class="tests">~8 tests → 312 cumulative</text>
  </g>

  <!-- S3 -->
  <g class="stage" transform="translate(300, 240)">
    <rect x="0" y="0" width="280" height="72" fill="#1c2333" stroke="#f0883e"/>
    <text x="140" y="20" text-anchor="middle" class="label">S3: Peng-Robinson EOS</text>
    <text x="140" y="35" text-anchor="middle" class="desc">Non-ideal thermo · departures · range alarms</text>
    <text x="140" y="49" text-anchor="middle" class="spec">New spec needed</text>
    <text x="140" y="63" text-anchor="middle" class="tests">~15 tests → 327 cumulative</text>
  </g>

  <!-- S5 -->
  <g class="stage" transform="translate(300, 430)">
    <rect x="0" y="0" width="280" height="72" fill="#1c2333" stroke="#f0883e"/>
    <text x="140" y="20" text-anchor="middle" class="label">S5: Pressure &amp; Flow</text>
    <text x="140" y="35" text-anchor="middle" class="desc">Reservoir · Cv · algebraic solver · NNG-17</text>
    <text x="140" y="49" text-anchor="middle" class="spec">RELEASESPEC_pressure_flow v7.0</text>
    <text x="140" y="63" text-anchor="middle" class="tests">~79 tests → 418 cumulative</text>
  </g>

  <!-- BRANCH LEFT: S4 from S3 -->
  <g class="stage" transform="translate(20, 360)">
    <rect x="0" y="0" width="240" height="72" fill="#1c2333" stroke="#484f58"/>
    <text x="120" y="20" text-anchor="middle" class="label">S4: Process Operations</text>
    <text x="120" y="35" text-anchor="middle" class="desc">Column · HEX fix · refrigeration</text>
    <text x="120" y="49" text-anchor="middle" class="spec">New spec needed</text>
    <text x="120" y="63" text-anchor="middle" class="tests">~12 tests → 339 cumulative</text>
  </g>

  <!-- BRANCH RIGHT: S6 from S2 -->
  <g class="stage" transform="translate(630, 250)">
    <rect x="0" y="0" width="240" height="72" fill="#1c2333" stroke="#484f58"/>
    <text x="120" y="20" text-anchor="middle" class="label">S6: Electrochemical Reactor</text>
    <text x="120" y="35" text-anchor="middle" class="desc">Power-driven chemistry</text>
    <text x="120" y="49" text-anchor="middle" class="spec">spec-electrochemical-reactor</text>
    <text x="120" y="63" text-anchor="middle" class="tests">~8 tests → 426 cumulative</text>
  </g>

  <!-- S7: merges S1 + S3 + S4 -->
  <g class="stage" transform="translate(20, 480)">
    <rect x="0" y="0" width="240" height="72" fill="#1c2333" stroke="#bc8cff"/>
    <text x="120" y="20" text-anchor="middle" class="label">S7: Performance Maps</text>
    <text x="120" y="35" text-anchor="middle" class="desc">Phase envelopes · feasibility · overlays</text>
    <text x="120" y="49" text-anchor="middle" class="spec">heatStream Ph1,3-5,7</text>
    <text x="120" y="63" text-anchor="middle" class="tests">~5 tests → 431 cumulative</text>
  </g>

  <!-- S8: reads all -->
  <g class="stage" transform="translate(300, 580)">
    <rect x="0" y="0" width="280" height="72" fill="#1c2333" stroke="#bc8cff"/>
    <text x="140" y="20" text-anchor="middle" class="label">S8: Game Infrastructure</text>
    <text x="140" y="35" text-anchor="middle" class="desc">Missions · campaign · shell</text>
    <text x="140" y="49" text-anchor="middle" class="spec">processThis-game-spec-v2</text>
    <text x="140" y="63" text-anchor="middle" class="tests">~30 tests → 461 cumulative</text>
  </g>

  <!-- CRITICAL PATH ARROWS -->
  <!-- S1 → S2 -->
  <path d="M440,92 L440,130" class="arrow arrow-crit" marker-end="url(#arrowhead-crit)"/>
  <!-- S2 → S3 -->
  <path d="M440,202 L440,240" class="arrow arrow-crit" marker-end="url(#arrowhead-crit)"/>
  <!-- S3 → S5 -->
  <path d="M440,312 L440,430" class="arrow arrow-crit" marker-end="url(#arrowhead-crit)"/>

  <!-- BRANCH ARROWS -->
  <!-- S3 → S4 (branch left) -->
  <path d="M340,312 C340,340 200,340 180,360" class="arrow arrow-dep" marker-end="url(#arrowhead)"/>
  <!-- S2 → S6 (branch right) -->
  <path d="M580,180 C620,180 700,220 720,250" class="arrow arrow-dep" marker-end="url(#arrowhead)"/>

  <!-- MERGE ARROWS -->
  <!-- S4 → S7 -->
  <path d="M140,432 L140,480" class="arrow arrow-merge" marker-end="url(#arrowhead-merge)"/>
  <!-- S1 → S7 (long arc) -->
  <path d="M300,72 C60,72 40,420 60,480" class="arrow arrow-merge" marker-end="url(#arrowhead-merge)"/>
  <!-- S3 → S7 (arc left) -->
  <path d="M300,290 C180,290 100,420 110,480" class="arrow arrow-merge" marker-end="url(#arrowhead-merge)"/>

  <!-- S5 → S8 -->
  <path d="M440,502 L440,580" class="arrow arrow-crit" marker-end="url(#arrowhead-crit)"/>
  <!-- S7 → S8 -->
  <path d="M200,552 C200,570 300,580 300,605" class="arrow arrow-merge" marker-end="url(#arrowhead-merge)"/>
  <!-- S6 → S8 -->
  <path d="M750,322 C750,520 580,590 580,605" class="arrow arrow-dep" marker-end="url(#arrowhead)"/>

  <!-- LEGEND -->
  <g class="legend" transform="translate(640, 20)">
    <rect x="0" y="0" width="230" height="85" fill="#161b22" stroke="#30363d" rx="6"/>
    <line x1="15" y1="20" x2="50" y2="20" stroke="#f0883e" stroke-width="2"/>
    <text x="58" y="24">Critical path</text>
    <line x1="15" y1="40" x2="50" y2="40" stroke="#484f58" stroke-width="2" stroke-dasharray="6 3"/>
    <text x="58" y="44">Branch dependency</text>
    <line x1="15" y1="60" x2="50" y2="60" stroke="#bc8cff" stroke-width="2" stroke-dasharray="4 4"/>
    <text x="58" y="64">Merge (reads from multiple)</text>
    <text x="15" y="78" fill="#58a6ff" font-style="italic" font-size="9">italic = spec document reference</text>
  </g>
</svg>
</body>
</html>
